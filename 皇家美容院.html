<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æŠ½å¡ç³»çµ± - çš‡å®¶ç¾å®¹é™¢</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-b from-gray-900 to-gray-800 text-white min-h-screen flex items-center justify-center">

  <div class="bg-gray-700 p-6 rounded-2xl shadow-2xl w-full max-w-md space-y-6 text-center">
    <h1 class="text-3xl font-bold text-yellow-300">ğŸŒ  çš‡å®¶ç¾å®¹é™¢</h1>

    <div class="flex justify-center space-x-4">
      <button onclick="selectGender('male')" id="maleBtn" class="px-4 py-2 rounded-full border border-white hover:bg-blue-600 transition">â™‚ ç”·æ€§</button>
      <button onclick="selectGender('female')" id="femaleBtn" class="px-4 py-2 rounded-full border border-white hover:bg-pink-600 transition">â™€ å¥³æ€§</button>
    </div>

    <div class="flex justify-center space-x-4">
      <button onclick="selectFunction('hair')" class="px-4 py-2 rounded-full bg-purple-600 hover:bg-purple-700 transition">âœ¨ çš‡å®¶ç¾é«®</button>
      <button onclick="selectFunction('surgery')" class="px-4 py-2 rounded-full bg-yellow-500 hover:bg-yellow-600 transition">ğŸ’ çš‡å®¶æ•´å½¢</button>
    </div>

    <div class="flex justify-center space-x-4">
      <button onclick="drawSingle()" class="px-4 py-2 rounded-full bg-green-600 hover:bg-green-700 transition">ğŸ² å–®æŠ½</button>
      <button onclick="clearHistory()" class="px-4 py-2 rounded-full bg-red-600 hover:bg-red-700 transition">ğŸ§¹ æ¸…é™¤ç´€éŒ„</button>
    </div>

    <!-- ç¾é«®é¡¯ç¤ºå€ -->
    <div id="hairSection" class="pt-4 text-sm text-gray-300 hidden">
      <div>ç´¯ç©æŠ½å¡æ•¸é‡ï¼ˆç¾é«®ï¼‰ï¼š<span id="totalDraws">0</span></div>
      <div>æŠ½åˆ°ä¸»1é ­é«®æ•¸é‡ï¼ˆç¾é«®ï¼‰ï¼š<span id="totalSSSItems">0</span> (<span id="hairSSSChance">0%</span>)</div>
      <div>æŠ½åˆ°ä¸»2é ­é«®æ•¸é‡ï¼ˆç¾é«®ï¼‰ï¼š<span id="totalSSItems">0</span> (<span id="hairSSChance">0%</span>)</div>
      <div>æŠ½åˆ°ä¸»3é ­é«®æ•¸é‡ï¼ˆç¾é«®ï¼‰ï¼š<span id="totalSItems">0</span> (<span id="hairSChance">0%</span>)</div>
      <div>æŠ½åˆ°ä¸»4é ­é«®æ•¸é‡ï¼ˆç¾é«®ï¼‰ï¼š<span id="totalAItems">0</span> (<span id="hairAChance">0%</span>)</div>
      <div id="hiddenBItems" class="hidden">æŠ½åˆ°Bç´šé“å…·æ•¸é‡ï¼ˆç¾é«®ï¼‰ï¼š<span id="totalBItems">0</span> (<span id="hairBChance">0%</span>)</div>
      <div id="hiddenCItems" class="hidden">æŠ½åˆ°Cç´šé“å…·æ•¸é‡ï¼ˆç¾é«®ï¼‰ï¼š<span id="totalCItems">0</span> (<span id="hairCChance">0%</span>)</div>
    </div>

    <!-- æ•´å½¢é¡¯ç¤ºå€ -->
    <div id="surgerySection" class="pt-4 text-sm text-gray-300 hidden">
      <div>ç´¯ç©æŠ½å¡æ•¸é‡ï¼ˆæ•´å½¢ï¼‰ï¼š<span id="totalDrawsSurgery">0</span></div>
      <div>æŠ½åˆ°ä¸»1çœ¼ç›æ•¸é‡ï¼ˆæ•´å½¢ï¼‰ï¼š<span id="totalSSSItemsSurgery">0</span> (<span id="surgerySSSChance">0%</span>)</div>
      <div>æŠ½åˆ°ä¸»2çœ¼ç›æ•¸é‡ï¼ˆæ•´å½¢ï¼‰ï¼š<span id="totalSSItemsSurgery">0</span> (<span id="surgerySSChance">0%</span>)</div>
      <div>æŠ½åˆ°ä¸»3çœ¼ç›æ•¸é‡ï¼ˆæ•´å½¢ï¼‰ï¼š<span id="totalSItemsSurgery">0</span> (<span id="surgerySChance">0%</span>)</div>
      <div>æŠ½åˆ°ä¸»çœ¼ç›æ•¸é‡ï¼ˆæ•´å½¢ï¼‰ï¼š<span id="totalAItemsSurgery">0</span> (<span id="surgeryAChance">0%</span>)</div>
    </div>

    <div id="history" class="pt-4 text-sm text-gray-300 max-h-96 overflow-y-auto space-y-2">
      <div class="font-bold text-white">æŠ½å–ç´€éŒ„</div>
    </div>
  </div>

  <script>
    let gender = null;
    let functionType = null;
    let totalDraws = 0;
    let totalSSSItems = 0, totalSSItems = 0, totalSItems = 0, totalAItems = 0, totalBItems = 0, totalCItems = 0;
    let totalDrawsSurgery = 0;
    let totalSSSItemsSurgery = 0, totalSSItemsSurgery = 0, totalSItemsSurgery = 0, totalAItemsSurgery = 0;
    let history = [];

    // ç¾é«®é“å…·æ•¸æ“šï¼ˆåŒ…æ‹¬ç”·æ€§å’Œå¥³æ€§çš„é“å…·æ•¸æ“šï¼‰
    const hairItems = [
      { name: "é»‘è‰²è¿·éœ§å®‰å‚‘æ´›é«®å‹", type: "SSS", chance: 0.75, gender: "male" },
      { name: "é»‘è‰²é–ƒé–ƒäº®æ™¶æ™¶é«®å‹", type: "SS", chance: 0.75, gender: "male" },
      { name: "é»‘è‰²è‘¡è„å‘³é«®å‹", type: "S", chance: 0.75, gender: "male" },
      { name: "é»‘è‰²ç™½æ™æ¿ƒéœ§é«®å‹", type: "A", chance: 0.75, gender: "male" },
      { name: "é»‘è‰²å„ªè³ªç”·å‹é€ å‹", type: "B", chance: 7.50, gender: "male" },
      { name: "é»‘è‰²å†°éœ§é€ å‹", type: "B", chance: 7.50, gender: "male" },
      { name: "é»‘è‰²è¿ªå€«é ­", type: "B", chance: 7.50, gender: "male" },
      { name: "é»‘è‰²å››æ–¹åˆºåˆºé«®å‹", type: "B", chance: 7.50, gender: "male" },
      { name: "é»‘è‰²ç«ç„°ç€æµ·é€ å‹", type: "C", chance: 16.75, gender: "male" },
      { name: "é»‘è‰²å“ˆå¯†ç“œé€ å‹", type: "C", chance: 16.75, gender: "male" },
      { name: "é»‘è‰²è“‹é ­è“‹è‡‰é€ å‹", type: "C", chance: 16.75, gender: "male" },
      { name: "é»‘è‰²æ¢…æœèé€ å‹", type: "C", chance: 16.75, gender: "male" },

      { name: "é»‘è‰²è¿·éœ§å®‰æ½”æ‹‰é«®å‹", type: "SSS", chance: 0.75, gender: "female" },
      { name: "é»‘è‰²é–ƒäº®äº®æ½¤å½©é«®å‹", type: "SS", chance: 0.75, gender: "female" },
      { name: "é»‘è‰²æ¿ƒéœ§è‰¾ç¾…è¿ªé«®å‹", type: "S", chance: 0.75, gender: "female" },
      { name: "é»‘è‰²äº®æ¾¤é«®å‹", type: "A", chance: 0.75, gender: "female" },
      { name: "é»‘è‰²æ‚ å¨œé€ å½¢", type: "B", chance: 7.50, gender: "female" },
      { name: "é»‘è‰²ç´€å¿µæ—¥é«®å‹", type: "B", chance: 7.50, gender: "female" },
      { name: "é»‘è‰²è¶…é•·æ³¢æµªé€ å‹", type: "B", chance: 7.50, gender: "female" },
      { name: "é»‘è‰²è´è¶èŠ±é€ å‹", type: "B", chance: 7.50, gender: "female" },
      { name: "é»‘è‰²æ¾æ¾å°¾æ²é€ å‹", type: "C", chance: 16.75, gender: "female" },
      { name: "é»‘è‰²è¼•ç›ˆé›™è¾®é€ å‹", type: "C", chance: 16.75, gender: "female" },
      { name: "é»‘è‰²è´è¶å°‘å¥³é€ å‹", type: "C", chance: 16.75, gender: "female" },
      { name: "é»‘è‰²ä¸¹å¦®å¡é€ å‹", type: "C", chance: 16.75, gender: "female" }
    ];

    // æ•´å½¢é“å…·æ•¸æ“š
    const surgeryItems = [
      { name: "å®‰æ½”æ‹‰è‡‰å‹", type: "SSS", chance: 1.67, gender: "female" },
      { name: "é‚£å€‹â€¦é‚£å€‹â€¦è‡‰å‹(é»‘è‰²ç³)", type: "SS", chance: 1.67, gender: "female" },
      { name: "éœ§é›¨è‡‰å‹", type: "S", chance: 1.67, gender: "female" },
      { name: "é»‘è‰²æ°´æ±ªæ±ªè‡‰å‹", type: "B", chance: 10.55, gender: "female" },
      { name: "é»‘è‰²æ˜äº®çš„è‡‰å‹", type: "B", chance: 10.55, gender: "female" },
      { name: "é»‘è‰²å¾ˆå›é€†è‡‰å‹", type: "B", chance: 10.55, gender: "female" },
      { name: "é»‘è‰²ä¹–å¥³å­©è‡‰å‹", type: "B", chance: 10.55, gender: "female" },
      { name: "é»‘è‰²è°æ˜çš„è‡‰å‹", type: "B", chance: 10.55, gender: "female" },
      { name: "é»‘è‰²æ‰å˜´çš„è‡‰å‹", type: "B", chance: 10.55, gender: "female" },

      { name: "é»‘è‰²å¡é “æ•´å½¢", type: "B", chance: 10.55, gender: "female" },
      { name: "é»‘è‰²è¶…æ–°æ˜Ÿè‡‰å‹", type: "B", chance: 10.55, gender: "female" },
      { name: "é»‘è‰²æ¸…ç§€è‡‰å½¢", type: "B", chance: 10.55, gender: "female" },

      { name: "å®‰å‚‘æ´›è‡‰å‹", type: "SSS", chance: 1.67, gender: "male" },
      { name: "é‚£å€‹â€¦é‚£å€‹â€¦è‡‰å‹(é»‘è‰²ç³)", type: "SS", chance: 1.67, gender: "male" },
      { name: "éœ§é›¨è‡‰å‹", type: "S", chance: 1.67, gender: "male" },
      { name: "é»‘è‰²å¾ˆæ¶çœ¼è‡‰å‹", type: "B", chance: 10.55, gender: "male" },
      { name: "é»‘è‰²æ˜äº®çš„è‡‰å‹", type: "B", chance: 10.55, gender: "male" },
      { name: "é»‘è‰²å¾ˆå›é€†è‡‰å‹", type: "B", chance: 10.55, gender: "male" },
      { name: "é»‘è‰²æš—ç¬‘çš„è‡‰å‹", type: "B", chance: 10.55, gender: "male" },
      { name: "é»‘è‰²æ¸…æ™°çš„è‡‰å‹", type: "B", chance: 10.55, gender: "male" },
      { name: "é»‘è‰²ç”Ÿæ°£çš„è‡‰å‹", type: "B", chance: 10.55, gender: "male" },
      { name: "é»‘è‰²çˆ½æœ—çš„è‡‰å‹", type: "B", chance: 10.55, gender: "male" },
      { name: "é»‘è‰²ç´”ç¾è‡‰å½¢", type: "B", chance: 10.55, gender: "male" },
      { name: "é»‘è‰²é™½å…‰ç”·è‡‰å‹", type: "B", chance: 10.55, gender: "male" }
    ];

    // è¨­ç½®æ€§åˆ¥
    function selectGender(g) {
      gender = g;
      document.getElementById("maleBtn").classList.toggle("bg-blue-600", g === 'male');
      document.getElementById("femaleBtn").classList.toggle("bg-pink-600", g === 'female');
    }

    // è¨­ç½®åŠŸèƒ½é¡å‹ï¼ˆçš‡å®¶ç¾é«®æˆ–çš‡å®¶æ•´å½¢ï¼‰
    function selectFunction(type) {
      functionType = type;
      if (type === 'hair') {
        document.getElementById("hairSection").classList.remove("hidden");
        document.getElementById("surgerySection").classList.add("hidden");
      } else if (type === 'surgery') {
        document.getElementById("surgerySection").classList.remove("hidden");
        document.getElementById("hairSection").classList.add("hidden");
      }
      const outputMessage = type === 'hair' ? 'é¸æ“‡äº† çš‡å®¶ç¾é«®' : 'é¸æ“‡äº† çš‡å®¶æ•´å½¢';
      document.getElementById("history").innerText = `å·²é¸æ“‡ï¼š${outputMessage}`;
    }

    // æ›´æ–°çµ±è¨ˆæ•¸æ“š
    function updateCounters() {
      if (functionType === 'hair') {
        document.getElementById("totalDraws").innerText = totalDraws;
        document.getElementById("totalSSSItems").innerText = totalSSSItems;
        document.getElementById("totalSSItems").innerText = totalSSItems;
        document.getElementById("totalSItems").innerText = totalSItems;
        document.getElementById("totalAItems").innerText = totalAItems;
        document.getElementById("totalBItems").innerText = totalBItems;
        document.getElementById("totalCItems").innerText = totalCItems;
      } else if (functionType === 'surgery') {
        document.getElementById("totalDrawsSurgery").innerText = totalDrawsSurgery;
        document.getElementById("totalSSSItemsSurgery").innerText = totalSSSItemsSurgery;
        document.getElementById("totalSSItemsSurgery").innerText = totalSSItemsSurgery;
        document.getElementById("totalSItemsSurgery").innerText = totalSItemsSurgery;
        document.getElementById("totalAItemsSurgery").innerText = totalAItemsSurgery;
      }
    }

    // æ›´æ–°æ­·å²ç´€éŒ„
    function updateHistory(result) {
      if (history.length >= 200) {
        history.pop();
      }
      history.unshift(result);

      const historyContainer = document.getElementById("history");
      historyContainer.innerHTML = "<div class='font-bold text-white'>æŠ½å–ç´€éŒ„</div>";
      history.forEach(item => {
        const recordElement = document.createElement("div");
        recordElement.innerText = item.name;

        // åªæœ‰SSSã€SSã€Sã€Aç´šé“å…·æ‰æœƒé¡¯ç¤ºé¡è‰²
        if (item.type === "SSS") {
          recordElement.classList.add("bg-red-600", "text-white");
        } else if (item.type === "SS") {
          recordElement.classList.add("bg-orange-600", "text-white");
        } else if (item.type === "S") {
          recordElement.classList.add("bg-yellow-500", "text-black");
        } else if (item.type === "A") {
          recordElement.classList.add("bg-green-500", "text-black");
        } else {
          // B å’Œ Cç­‰ç´šçš„é“å…·æ²¡æœ‰é¡è‰²
          recordElement.classList.add("text-white");
        }

        recordElement.classList.add("p-2", "rounded-lg", "mb-2");
        historyContainer.appendChild(recordElement);
      });
    }

    // å–®æŠ½é‚è¼¯
    function drawSingle() {
      if (!gender || !functionType) {
        document.getElementById("history").innerText = "è«‹å…ˆé¸æ“‡æ€§åˆ¥å’Œå½—æ˜ŸåŠŸèƒ½ï¼";
        return;
      }

      if (functionType === 'hair') {
        totalDraws++;
      } else if (functionType === 'surgery') {
        totalDrawsSurgery++;
      }

      let availableItems;
      if (functionType === 'hair') {
        availableItems = hairItems.filter(item => item.gender === null || item.gender === gender);
      } else if (functionType === 'surgery') {
        availableItems = surgeryItems.filter(item => item.gender === null || item.gender === gender);
      }

      const totalChance = availableItems.reduce((total, item) => total + item.chance, 0);

      let randomNum = Math.random() * totalChance;
      let selectedItem = null;

      for (let item of availableItems) {
        randomNum -= item.chance;
        if (randomNum <= 0) {
          selectedItem = item;
          break;
        }
      }

      // æ ¹æ“šé¸æ“‡çš„é“å…·é¡å‹é€²è¡Œçµ±è¨ˆ
      if (functionType === 'hair') {
        if (selectedItem.type === "SSS") {
          totalSSSItems++;
        } else if (selectedItem.type === "SS") {
          totalSSItems++;
        } else if (selectedItem.type === "S") {
          totalSItems++;
        } else if (selectedItem.type === "A") {
          totalAItems++;
        } else if (selectedItem.type === "B") {
          totalBItems++;
        } else if (selectedItem.type === "C") {
          totalCItems++;
        }
      } else if (functionType === 'surgery') {
        if (selectedItem.type === "SSS") {
          totalSSSItemsSurgery++;
        } else if (selectedItem.type === "SS") {
          totalSSItemsSurgery++;
        } else if (selectedItem.type === "S") {
          totalSItemsSurgery++;
        } else if (selectedItem.type === "A") {
          totalAItemsSurgery++;
        }
      }
// âœ… æ’å…¥åœ¨ç¬¬ 252 è¡Œä¹‹å¾Œï¼ˆåœ¨ updateHistory(...) ä¹‹å‰ï¼‰

if (functionType === 'hair') {
  document.getElementById("hairSSSChance").innerText = totalDraws > 0 ? ((totalSSSItems / totalDraws) * 100).toFixed(2) + "%" : "0%";
  document.getElementById("hairSSChance").innerText = totalDraws > 0 ? ((totalSSItems / totalDraws) * 100).toFixed(2) + "%" : "0%";
  document.getElementById("hairSChance").innerText = totalDraws > 0 ? ((totalSItems / totalDraws) * 100).toFixed(2) + "%" : "0%";
  document.getElementById("hairAChance").innerText = totalDraws > 0 ? ((totalAItems / totalDraws) * 100).toFixed(2) + "%" : "0%";
  document.getElementById("hairBChance").innerText = totalDraws > 0 ? ((totalBItems / totalDraws) * 100).toFixed(2) + "%" : "0%";
  document.getElementById("hairCChance").innerText = totalDraws > 0 ? ((totalCItems / totalDraws) * 100).toFixed(2) + "%" : "0%";
} else if (functionType === 'surgery') {
  document.getElementById("surgerySSSChance").innerText = totalDrawsSurgery > 0 ? ((totalSSSItemsSurgery / totalDrawsSurgery) * 100).toFixed(2) + "%" : "0%";
  document.getElementById("surgerySSChance").innerText = totalDrawsSurgery > 0 ? ((totalSSItemsSurgery / totalDrawsSurgery) * 100).toFixed(2) + "%" : "0%";
  document.getElementById("surgerySChance").innerText = totalDrawsSurgery > 0 ? ((totalSItemsSurgery / totalDrawsSurgery) * 100).toFixed(2) + "%" : "0%";
  document.getElementById("surgeryAChance").innerText = totalDrawsSurgery > 0 ? ((totalAItemsSurgery / totalDrawsSurgery) * 100).toFixed(2) + "%" : "0%";
}
      updateHistory(selectedItem);
      updateCounters();
    }

    // æ¸…ç©ºæ­·å²ç´€éŒ„
    function clearHistory() {
      history = [];
      totalDraws = 0;
      totalSSSItems = 0;
      totalSSItems = 0;
      totalSItems = 0;
      totalAItems = 0;
      totalBItems = 0;
      totalCItems = 0;
      totalDrawsSurgery = 0;
      totalSSSItemsSurgery = 0;
      totalSSItemsSurgery = 0;
      totalSItemsSurgery = 0;
      totalAItemsSurgery = 0;
      updateCounters();
      document.getElementById("history").innerHTML = "<div class='font-bold text-white'>æŠ½å–ç´€éŒ„</div>";
    }
  </script>
</body>
</html>

